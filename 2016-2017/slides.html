<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>CI / CD Introduction with Jenkins</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js/css/reveal.css" rel="stylesheet"><link rel="stylesheet" href="./build/build.css" id="theme"><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet"><script>document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script></head><body><div class="reveal"><div class="slides"><section class="title"><h1>CI / CD Introduction with Jenkins</h1></section><section id="toc"><h2>ToC</h2><div class="ulist"><ul><li><p><a href="#source_code_management_scm">Source Code Management(SCM)</a></p></li><li><p><a href="#testing_software">Testing Software</a></p></li><li><p><a href="#continuous_world_fundamentals">Continuous World Fundamentals</a></p></li><li><p><a href="#deployment_cd_pipeline">Deployment &amp; CD Pipeline</a></p></li><li><p><a href="#the_feedback_loop">The Feedback Loop</a></p></li><li><p><a href="#security">Security</a></p></li><li><p><a href="#configuration_management_cm">Configuration Management (CM)</a></p></li><li><p><a href="#containers">Containers</a></p></li><li><p><a href="#jenkins_overview">Jenkins Overview</a></p></li><li><p><a href="#cloudbees_introduction">CloudBees Introduction</a></p></li><li><p><a href="#lab">Practical Exercise: Lab</a></p></li></ul></div></section>
<section><section id="source_code_management_scm"><h2>Source Code Management (SCM)</h2></section><section id="why_use_an_scm"><h2>Why use an SCM ?</h2><div class="paragraph"><p>When working as a development team, an SCM will allow you:</p></div>
<div class="ulist"><ul><li><p>To <strong>collaborate</strong> efficiently on a single codebase</p><div class="ulist"><ul><li><p>Helping resolve code conflicts</p></li><li><p>Making it easy to share contents</p></li></ul></div></li><li><p>To keep track of <strong>every change</strong>: SCM as a <em>Single Source of Truth</em></p><div class="ulist"><ul><li><p>Providing a complete history</p></li><li><p>Allowing easy rollback to earlier versions</p></li></ul></div></li></ul></div></section><section id="what_are_scms"><h2>What are SCMs ?</h2><div class="paragraph"><p>Source Code Management systems, also known as "Version Control Systems" (VCS):</p></div>
<div class="ulist"><ul><li><p>Are <strong>software</strong> systems</p></li><li><p>Record <strong>all</strong> changes of a set of files over time</p></li><li><p>Allows you to <strong>share</strong> those changes</p></li><li><p>Provide <strong>merging</strong> and <strong>tracking</strong> capabilities over the recorded changes</p></li></ul></div></section><section id="what_are_the_different_types_of_scm"><h2>What are the different types of SCM?</h2><div class="paragraph"><p>We can see 3 types of SCM:</p></div>
<div class="ulist"><ul><li><p><strong>Local</strong></p></li><li><p><strong>Centralized</strong></p></li><li><p><strong>Distributed</strong></p></li></ul></div></section><section id="local_scm"><h2>Local SCM</h2><div class="ulist"><ul><li><p>Older ones</p></li><li><p><strong>Only</strong> track history:</p><div class="ulist"><ul><li><p>Use a <em>"Version Database"</em> of all the file versions</p></li><li><p>Stores differences between versions (<em>"diff"</em>)</p></li></ul></div></li><li><p>Sharing problem <strong>not</strong> addressed</p></li><li><p>Example: <em>rcs</em> (still in Apple XCode Tools)</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-local.png" alt="scm local" width="300"></div></section><section id="centralized_scm_cvcs"><h2>Centralized SCM (CVCS)</h2><div class="ulist"><ul><li><p>Less old and <strong>still widely</strong> used</p></li><li><p>Covers <strong>both</strong> history and sharing:</p><div class="ulist"><ul><li><p>History is the same as local SCMs</p></li><li><p>The "version database" is stored on a <strong>central</strong> server</p></li></ul></div></li><li><p>Each developer is a client with <strong>only 1</strong> (at a time) version of the codebase</p></li><li><p>Easy learning curve</p></li><li><p>Example: CVS, SVN, Perforce, TFS</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-centralized.png" alt="scm centralized" width="300"></div></section><section id="distributed_scm_dvcs"><h2>Distributed SCM (DVCS)</h2><div class="ulist"><ul><li><p>Almost the same as CVCS, but the "Version Database" is
<strong>distributed by duplication</strong> on every node</p><div class="ulist"><ul><li><p>When centralized server is down, you can keep working</p></li><li><p>Better Conflict resolution, improving collaboration process</p></li></ul></div></li><li><p>Learning curve is a bit more difficult compared to centralized SCMs</p></li><li><p>Example: Git, Mercurial, Bazaar, Monotone</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-distributed.png" alt="scm distributed" width="300"></div></section><section id="cloud_based_scm"><h2>Cloud-based SCM</h2><div class="ulist"><ul><li><p>You can consider them as "SCM as a Service"</p></li><li><p>The <em>"Version Database"</em> is hosted in a Cloud Web Service</p><div class="ulist"><ul><li><p>Pro: Delegate the hosting and managing of your SCM, focus on using it</p></li><li><p>Con: Your codebase is on another company system</p></li></ul></div></li><li><p>Also provides valuable services around your codebase like online text editor,
visual tools, issue tracker, etc&#8230;&#8203;</p></li><li><p>Examples: Github, Bitbucket by Atlassian, Amazon CodeCommit, Visual Studio Online by Microsoft,
SourceForge, GitLab, etc.</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-cloud.png" alt="scm cloud"></div></section><section id="scm_terminology_basics"><h2>SCM Terminology: Basics</h2><div class="ulist"><ul><li><p>Each set of changed lines on a <strong>single</strong> file is a <em>"diff"</em></p></li><li><p>A set of diffs which have been explicitly validated are a <em>"commit"</em><br>
<span class="image"><img src="./images/scm-basics-legend.png" alt="scm basics legend"></span></p></li><li><p>A commit is in fact a new version of the codebase</p></li><li><p>A commit can exist only locally or only remotely</p></li><li><p>The latest commit on the history is the <em>"HEAD"</em></p></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-basics-history.png" alt="scm basics history"></div></section><section id="scm_terminology_branches"><h2>SCM Terminology: Branches</h2><div class="ulist"><ul><li><p>A <strong>branch</strong>, in SCM terminology, is a pointer to a single commit</p><div class="ulist"><ul><li><p><em>HEAD</em> is the "latest" branch, also known as the "master" branch</p></li><li><p>To integrate a branch, you have to <strong>merge</strong> it:<br>
<span class="image"><img src="./images/scm-branches.png" alt="scm branches"></span></p></li></ul></div></li></ul></div></section><section id="scm_terminology_pull_request"><h2>SCM Terminology: Pull Request</h2><div class="ulist"><ul><li><p>A <strong>Pull-Request</strong> is a way of handling branch merges to "master"</p><div class="ulist"><ul><li><p>A branch is pushed to the central server without having been <strong>merged</strong></p></li><li><p>It <em>"asks"</em> to be merged on a central repository</p></li><li><p>Opportunity is given to review the changes <strong>before</strong> merging</p></li><li><p>Pull request ends by being closed or <strong>merged</strong> to destination branch</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-pull-request.png" alt="scm pull request"></div></section><section id="how_to_use_scm_workflow_patterns"><h2>How to use SCM ? Workflow Patterns</h2><div class="paragraph"><p>Usage of VCS/SCM made well-known patterns emerge:</p></div>
<div class="ulist"><ul><li><p>Centralized Workflow pattern</p></li><li><p>Feature Branch Workflow pattern</p></li><li><p>Git Workflow pattern</p></li><li><p>Forking Workflow pattern</p></li></ul></div></section><section id="centralized_workflow_pattern"><h2>Centralized Workflow Pattern</h2><div class="imageblock" style=""><img src="./images/scm-centralized-flow.png" alt="scm centralized flow"></div>
<div class="ulist"><ul><li><p>This pattern is the natural usage of a CVCS like SVN or CVS</p></li><li><p>It is easy to understand and use, and sufficient enough for a lot of cases</p></li><li><p>Collaboration is blocked when centralized server is down or history is broken</p></li></ul></div></section><section id="centralized_workflow_pattern_how_to"><h2>Centralized Workflow pattern: How to ?</h2><div class="imageblock" style=""><img src="./images/scm-centralized-flow-how-to.jpg" alt="scm centralized flow how to" width="800"></div></section><section id="feature_branch_workflow_pattern"><h2>Feature Branch Workflow Pattern</h2><div class="ulist"><ul><li><p>Goal of this pattern: using <strong>one</strong> branch <strong>per</strong> feature</p><div class="ulist"><ul><li><p>Encapsulation allows working without disturbing the main codebase</p></li><li><p>Allows easier collaboration</p></li><li><p>Merge conflicts maps the conceptual conflicts: easier to track</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><a class="image" href="https://twitter.com/jay_gee/status/702638177471873024"><img src="./images/scm-feature-branch-workflow.png" alt="scm feature branch workflow"></a></div></section><section id="git_workflow_pattern"><h2>Git Workflow Pattern</h2><div class="ulist"><ul><li><p>Extension of the Feature Branch Workflow pattern</p></li><li><p>Proposed by Vincent Driessen at <a href="http://nvie.com">nvie</a></p></li><li><p>Target large-scale projects or software products</p></li><li><p>Strict branching implementation: roles for specific branches</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-git-workflow.png" alt="scm git workflow" width="600"></div></section><section id="fork_workflow_pattern"><h2>Fork Workflow Pattern</h2><div class="ulist"><ul><li><p>Pattern inherited from (GitHub/Bitbucket)-like services</p></li><li><p>Push forward concepts of distributed file systems</p></li><li><p>Each user <em>"forks"</em> the main repository and can propose pull requests
between repositories</p><div class="ulist"><ul><li><p>Authorization management improved</p></li><li><p>Autonomy for better collaboration process</p></li><li><p>Decentralized for new patterns ("promiscuous integration")</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="./images/scm-fork-workflow.png" alt="scm fork workflow" height="300"></div></section><section id="using_scm_to_solve_problems"><h2>Using SCM to solve problems</h2><div class="ulist"><ul><li><p>Infrastructure as Code is a good example of using SCM
to solves common problems:</p><div class="ulist"><ul><li><p>Goal: Defining an infrastructure system</p></li><li><p>Operating the infrastructure is changing those definitions (adding/deleting machines, updating ones, etc.)</p></li><li><p>Collaboration is required on this changes</p></li></ul></div></li><li><p>Using text files stored in SCM solve this problem:</p><div class="ulist"><ul><li><p>Mapping conflicts to an automated process: merging</p></li><li><p>Allowing same collaboration and authorization as for code</p></li></ul></div></li></ul></div></section><section id="what_did_we_learn"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>Codebases are versioned in SCM (VCS), which are software that keep track of all changes and help to share source code.</p></li><li><p>We have 2 "main" types: Centralized and Distributed VCS</p></li><li><p>Depending on your needs and the VCS, you should use the most efficient pattern
for your codebase: Centralized, Feature Branch, GitFlow, Fork</p></li><li><p>Storing your codebase is not a free meal: think about backup, crash, privacy</p></li></ul></div></section><section id="going_further"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="https://www.atlassian.com/git/tutorials/comparing-workflows" class="bare">https://www.atlassian.com/git/tutorials/comparing-workflows</a></p></li><li><p><a href="http://martinfowler.com/bliki/VersionControlTools.html" class="bare">http://martinfowler.com/bliki/VersionControlTools.html</a></p></li><li><p><a href="https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control" class="bare">https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control</a></p></li><li><p><a href="http://martinfowler.com/bliki/FeatureBranch.html" class="bare">http://martinfowler.com/bliki/FeatureBranch.html</a></p></li><li><p><a href="http://nvie.com/posts/a-successful-git-branching-model/" class="bare">http://nvie.com/posts/a-successful-git-branching-model/</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Infrastructure_as_Code" class="bare">https://en.wikipedia.org/wiki/Infrastructure_as_Code</a></p></li><li><p><a href="https://www.simple-talk.com/opinion/opinion-pieces/branching-and-merging-ten-pretty-good-practices/" class="bare">https://www.simple-talk.com/opinion/opinion-pieces/branching-and-merging-ten-pretty-good-practices/</a></p></li></ul></div></section></section>
<section><section id="software_testing"><h2>Software Testing</h2></section><section id="why_testing_software"><h2>Why testing Software ?</h2><div class="ulist"><ul><li><p><a href="http://istqbexamcertification.com/when-do-defects-in-software-testing-arise/">Human always makes mistakes</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Turing_test">Human write code</a></p></li><li><p>Code can have mistakes</p></li><li><p>Those mistakes have consequences</p></li><li><p>Assume this imply that code <strong>must</strong> be tested</p></li></ul></div></section><section id="what_is_software_testing"><h2>What is "Software Testing" ?</h2><div class="ulist"><ul><li><p>Testing software follows two baselines:</p><div class="ulist"><ul><li><p>Validating that the software <strong>complies</strong> with its goals</p></li><li><p>Searching for <strong>defects</strong> to <strong>improve</strong> the software quality</p></li></ul></div></li></ul></div></section><section id="automated_or_manual_testings"><h2>Automated or Manual Testings ?</h2><div class="ulist"><ul><li><p>Automated = <strong>big outcome</strong>, can be <em>repeated</em></p></li><li><p>Consider Manual testing (with caution) when:</p><div class="ulist"><ul><li><p>cost of automation exceeds testing outcome</p></li><li><p>automation not possible (data or hardware constraint)</p></li></ul></div></li></ul></div></section><section id="software_testing_terminology"><h2>Software Testing terminology</h2><div class="ulist"><ul><li><p><strong>SUT</strong>: "System Under Testing". It defines the boundaries.</p></li><li><p><strong>Test double</strong>: Generic term used for objects and procedures
that are simplified versions of sub-part of the SUT.
E.g. Mock, Stub, Spy, etc.</p></li><li><p><strong>Automated testing</strong>: Using software outside the SUT,
to run and control the testing suites, in a repetitive and reproducible way</p></li></ul></div></section><section id="how_to_do_software_testing"><h2>How to do "Software Testing" ?</h2><div class="paragraph"><p>Different types of software testing exists.<br>
Here are some that we will cover:</p></div>
<div class="ulist"><ul><li><p>Unit testing</p></li><li><p>Integration testing</p></li><li><p>Smoke testing</p></li><li><p>Functional Testing</p></li><li><p>Non-Regression testing</p></li><li><p>Acceptance testing</p></li></ul></div></section><section id="unit_testing"><h2>Unit Testing</h2><div class="paragraph"><p>A unit test is:</p></div>
<div class="ulist"><ul><li><p>Focusing on the smaller sub-system possible, defined as a "unit"</p></li><li><p><strong>Quick</strong> to run</p><div class="ulist"><ul><li><p>Each change of code should trigger a unit test, speed is <strong>key</strong></p></li></ul></div></li><li><p><strong>Independents</strong> with each others</p><div class="ulist"><ul><li><p>Run order must <strong>not</strong> matter</p></li></ul></div></li><li><p>SUT is considered as white box</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/test-unit.png" alt="test unit" width="400"></div></section><section id="integration_testing"><h2>Integration Testing</h2><div class="paragraph"><p>Integration testing is the next step:</p></div>
<div class="ulist"><ul><li><p>Validate integration <strong>between</strong> multiple sub-systems<br>
<span class="image"><img src="./images/test-integration.gif" alt="test integration"></span></p></li><li><p>Sub-Systems refers to:</p><div class="ulist"><ul><li><p>Internal sub-system: already validated by a unit test</p></li><li><p>External sub-system: external element like a database, filesystem&#8230;&#8203;</p></li></ul></div></li><li><p>"Integration testing" can covers a lot of subject and may be slower to run</p></li><li><p>SUT is considered as white box</p></li></ul></div></section><section id="smoke_testing"><h2>Smoke Testing</h2><div class="paragraph"><p>The goal of the smoke test
is to <strong>fail-fast</strong>
or conduct further tests on the SUT.</p></div>
<div class="ulist"><ul><li><p>It validates the basics functions of the system</p></li><li><p>Also known as "Sanity Checking"</p></li><li><p>It is a kind of <strong>simple</strong> integration test</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/test-smoke.jpg" alt="test smoke" width="400"></div>
<div class="quoteblock"><blockquote><em>
If it smokes, it&#8217;s bad
</em></blockquote><div class="attribution">&#8212; Anonymous Electrician</div></div></section><section id="functional_testing"><h2>Functional Testing</h2><div class="ulist"><ul><li><p>Validate the software behaviors against the expectations of the <strong>maker</strong></p></li><li><p>It focus on <em>"normal"</em> behaviors and requirements</p></li><li><p>SUT is considered as a <strong>black box</strong></p></li></ul></div></section><section id="non_regression_testing"><h2>Non-Regression Testing</h2><div class="ulist"><ul><li><p>Validate that the SUT keeps bringing at least the same outcome</p></li><li><p>Works by focusing on a <strong>single</strong> and <strong>buggy</strong> behavior of the SUT</p></li><li><p>It ensures that this <em>buggy</em> behavior will not occurs again</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/test-regression.png" alt="test regression" width="200"></div>
<div class="quoteblock"><blockquote><em>
Correcting a single bug may introduce several more.
</em></blockquote><div class="attribution">&#8212; Any developer</div></div></section><section id="acceptance_testing"><h2>Acceptance testing</h2><div class="ulist"><ul><li><p>Also known as "UAT": User Acceptance Testing or "End User testing"</p></li><li><p>Test suites of the full SUT, <strong>focused</strong> on the end-user use cases and feeling</p></li><li><p>Done <strong>with</strong> end-users</p></li><li><p>SUT is considered as a <strong>black box</strong></p></li></ul></div>
<div class="imageblock" style=""><img src="./images/test-acceptance.jpg" alt="test acceptance" width="300"></div></section><section id="what_did_we_learn_2"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>Testing is highly recommended to fix outcomes</p></li><li><p>Automating everything to avoid having to test the tests</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/test-pyramid.png" alt="test pyramid" width="800"></div></section><section id="going_further_2"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="http://martinfowler.com/bliki/UnitTest.html" class="bare">http://martinfowler.com/bliki/UnitTest.html</a></p></li><li><p><a href="http://stackoverflow.com/questions/520064/what-is-unit-test-integration-test-smoke-test-regression-test" class="bare">http://stackoverflow.com/questions/520064/what-is-unit-test-integration-test-smoke-test-regression-test</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Software_testing" class="bare">https://en.wikipedia.org/wiki/Software_testing</a></p></li><li><p><a href="http://martinfowler.com/tags/testing.html" class="bare">http://martinfowler.com/tags/testing.html</a></p></li><li><p><a href="http://martinfowler.com/bliki/TestCoverage.html" class="bare">http://martinfowler.com/bliki/TestCoverage.html</a></p></li><li><p><a href="http://martinfowler.com/bliki/TestDrivenDevelopment.html" class="bare">http://martinfowler.com/bliki/TestDrivenDevelopment.html</a></p></li><li><p><a href="https://adamcod.es/2014/05/15/test-doubles-mock-vs-stub.html" class="bare">https://adamcod.es/2014/05/15/test-doubles-mock-vs-stub.html</a></p></li></ul></div></section></section>
<section><section id="continuous_world_fundamentals"><h2>"Continuous World" Fundamentals</h2></section><section id="defining_fundamentals"><h2>Defining Fundamentals</h2><div class="paragraph"><p>This section will describe <strong>why</strong> and <strong>what</strong> are:</p></div>
<div class="ulist"><ul><li><p>Continuous Integration</p></li><li><p>Continuous Delivery</p></li><li><p>Continuous Deployment</p></li></ul></div></section><section id="continuous_integration_ci"><h2>Continuous Integration (CI)</h2></section><section id="why_doing_continuous_integration"><h2>Why doing Continuous Integration ?</h2><div class="paragraph"><p>Allows a team to develop cohesive software more rapidly</p></div>
<div class="imageblock" style=""><a class="image" href="http://cartoontester.blogspot.be/2010/01/big-bugs.html"><img src="./images/big-bugs.jpg" alt="big bugs" width="500"></a></div>
<div class="quoteblock"><blockquote><div class="paragraph"><p>Continuous Integration doesn’t get rid of bugs, but it does make them dramatically easier to find and remove.</p></div></blockquote><div class="attribution">&#8212; Martin Fowler</div></div></section><section id="what_is_continuous_integration_ci"><h2>What is Continuous Integration (CI)?</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Continuous Integration is a software development <strong>practice</strong> where members of a team integrate their work <strong>frequently</strong>, usually each person integrates at least daily - leading to <strong>multiple</strong> integrations per day.</p></div></blockquote><div class="attribution">&#8212; Martin Fowler - Continuous Integration</div></div></section><section id="how_to_do_continuous_integration"><h2>How to do Continuous Integration ?</h2><div class="ulist"><ul><li><p>Each integration is verified by an <strong>automated</strong> build (including test)</p></li><li><p>Integrate code <strong>often</strong>, at least daily, to make integration a <strong>non-event</strong></p></li><li><p><strong>Continuously</strong> build and integrate</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/ci-howto.png" alt="ci howto" width="600"></div></section><section id="continuous_delivery_cd"><h2>Continuous Delivery (CD)</h2></section><section id="why_doing_continuous_delivery"><h2>Why doing Continuous Delivery ?</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>How long would it take to your organization to deploy a change that
involves just one single line of code?</p></div></blockquote></div>
<div class="imageblock" style=""><img src="./images/poll-release-cadence.jpg" alt="poll release cadence" width="600"></div>
<div class="ulist"><ul><li><p>Reduce deployment risks</p></li><li><p>Allow more frequent user feedback</p></li><li><p>Make progress believable by everyone</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Mary and Tom Poppendieck wrote the <em>Lean Software Development: An Agile Toolkit</em> book in 2003
<a href="http://www.poppendieck.com/" class="bare">http://www.poppendieck.com/</a></p></div></aside></section><section id="what_is_continuous_delivery"><h2>What is Continuous Delivery ?</h2><div class="paragraph"><p>Continuous Delivery is the next step after Continuous Integration:</p></div>
<div class="ulist"><ul><li><p>Every change to the system <strong>can</strong> be released for <strong>production</strong></p></li><li><p>Delivery can be done at <strong>any</strong> time, on <strong>any</strong> environment</p></li></ul></div>
<div class="imageblock" style=""><a class="image" href="http://blog.arungupta.me/continuous-integration-delivery-deployment-maturity-model"><img src="./images/cd-what.png" alt="cd what" width="300"></a></div>
<div class="quoteblock"><blockquote><div class="paragraph"><p>Your team prioritizes keeping the software <strong>deployable</strong> over working on new features</p></div></blockquote><div class="attribution">&#8212; Martin Fowler</div></div></section><section id="how_to_do_continuous_delivery"><h2>How to do Continuous Delivery ?</h2><div class="ulist"><ul><li><p>Having a collaborating working relationship with <strong>everyone</strong> involved</p></li><li><p>Using <strong>Deployment Pipelines</strong>, which are automated implementations of your application’s build lifecycle process (cf. next chapter)</p></li></ul></div>
<div class="imageblock" style=""><a class="image" href="https://xebia.github.io/cd-with-docker"><img src="./images/cd-howto-pipeline.png" alt="cd howto pipeline" width="800"></a></div></section><section id="continuous_deployment"><h2>Continuous Deployment</h2></section><section id="what_is_continuous_deployment"><h2>What is Continuous Deployment ?</h2><div class="ulist"><ul><li><p>Continuous Deployment is the latest step after Continuous Delivery.</p></li><li><p><strong>Any change</strong> to the system is pushed to <strong>production</strong> in an automated way.</p></li></ul></div>
<div class="imageblock" style=""><a class="image" href="http://blog.arungupta.me/continuous-integration-delivery-deployment-maturity-model"><img src="./images/continuous-deployment.png" alt="continuous deployment" width="400"></a></div></section><section id="continuous_delivery_versus_deployment"><h2>Continuous Delivery versus Deployment</h2><div class="paragraph"><p>Both are always confused:</p></div>
<div class="ulist"><ul><li><p>Hence relying on automation, CD still needs a <strong>manual</strong> step before production.</p></li></ul></div>
<div class="imageblock" style=""><a class="image" href="http://blog.crisp.se/2013/02/05/yassalsundman/continuous-delivery-vs-continuous-deployment"><img src="./images/continuous-depl-vs-delivery.jpg" alt="continuous depl vs delivery" width="700"></a></div></section><section id="what_did_we_learn_3"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>Continuous Integration (CI) is an automated way of integrating code often</p></li><li><p>Continuous Delivery (CD) is the natural extension of CI, that make the code
always ready to be deployed</p></li><li><p>Continuous Deployment is the next step, that make any change deployed to
production</p></li></ul></div></section><section id="going_further_3"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="http://martinfowler.com/articles/continuousIntegration.html" class="bare">http://martinfowler.com/articles/continuousIntegration.html</a></p></li><li><p><a href="http://martinfowler.com/bliki/ContinuousDelivery.html" class="bare">http://martinfowler.com/bliki/ContinuousDelivery.html</a></p></li><li><p><a href="https://jaxenter.com/implementing-continuous-delivery-117916.html" class="bare">https://jaxenter.com/implementing-continuous-delivery-117916.html</a></p></li><li><p><a href="https://technologyconversations.com/2014/04/29/continuous-delivery-introduction-to-concepts-and-tools/" class="bare">https://technologyconversations.com/2014/04/29/continuous-delivery-introduction-to-concepts-and-tools/</a></p></li><li><p><a href="http://blog.arungupta.me/continuous-integration-delivery-deployment-maturity-model" class="bare">http://blog.arungupta.me/continuous-integration-delivery-deployment-maturity-model</a></p></li><li><p><a href="http://blog.crisp.se/2013/02/05/yassalsundman/continuous-delivery-vs-continuous-deployment" class="bare">http://blog.crisp.se/2013/02/05/yassalsundman/continuous-delivery-vs-continuous-deployment</a></p></li></ul></div></section></section>
<section><section id="deployment_cd_pipeline"><h2>Deployment &amp; CD Pipeline</h2></section><section id="why_use_a_cd_pipeline"><h2>Why use a CD Pipeline ?</h2><div class="ulist"><ul><li><p>Competitive advantage is given by creating <strong>value</strong> across you set of activity</p></li><li><p>A "Value Chain" is a modelization of you business to <strong>measure</strong> both</p><div class="ulist"><ul><li><p>Global Value</p></li><li><p>Residual value to re-inject in the value chain</p></li></ul></div></li><li><p>Using a "CD Pipelines" gives same outcome as a value or supply chain in
other industries</p></li><li><p>"Fast is cheap": Pipeline makes failure detection as early as possible</p></li></ul></div></section><section id="what_is_a_cd_pipeline"><h2>What is a CD Pipeline ?</h2><div class="ulist"><ul><li><p>Model of the value stream of your software production business</p><div class="ulist"><ul><li><p>This is the value stream mapping of the process</p></li></ul></div></li><li><p>Central Foundation to achieve Continuous Delivery</p><div class="ulist"><ul><li><p>We also name this a <strong>Deployment Pipeline</strong></p></li></ul></div></li><li><p>It is driven by the <strong>fail-fast</strong> concept</p></li></ul></div></section><section id="cd_pipeline_anatomy"><h2>CD Pipeline Anatomy</h2><div class="ulist"><ul><li><p>Composed by <em>stages</em>, mapped to a measurable step</p></li><li><p>Transition between 2 stages is a <em>gate</em></p><div class="ulist"><ul><li><p>Manual or Automated</p></li><li><p><em>gates</em> triggers next stage</p></li></ul></div></li><li><p>Stages are run sequentially and/or in parallel</p><div class="ulist"><ul><li><p>Thus <em>gates</em> can be multi-directionals</p></li></ul></div></li><li><p>Driven by atomic change: generally SCM single commit</p></li></ul></div></section><section id="a_cd_pipeline_example"><h2>A CD Pipeline Example</h2><div class="imageblock" style=""><img src="./images/cd-pipeline-example.jpg" alt="cd pipeline example"></div></section><section id="deployment_stages_of_a_cd_pipeline"><h2>Deployment Stages of a CD Pipeline</h2><div class="ulist"><ul><li><p><strong>Deployment</strong> is the set of actions that makes a software system ready for usage</p></li><li><p>Deploying a software is made on <strong>environments</strong></p></li><li><p>Environments are isolated runtimes with specific properties:</p><div class="ulist"><ul><li><p>Production is where software lives for end users and bring outcomes</p></li><li><p>Testing environment are locations where to run test against software</p></li><li><p>Disaster Recovery Environment is an emergency location to run software when a disaster occurs on production</p></li></ul></div></li></ul></div></section><section id="automated_deployment"><h2>Automated Deployment</h2><div class="paragraph"><p>Using <em>automation</em> for a deployment stage:</p></div>
<div class="ulist"><ul><li><p>Make deployment repeatable and less error-prone</p></li><li><p>Bring ROI when deploying on new environment</p></li><li><p>Make frequent releases possible by bringing <em>confidence</em></p></li><li><p>Still can require a manual (read: <em>human</em>) trigger to have validation gate</p></li></ul></div></section><section id="how_to_do_goods_cd_pipelines"><h2>How to do Goods CD Pipelines ?</h2><div class="ulist"><ul><li><p>Pipelines driven by 2 golden rules:</p><div class="ulist"><ul><li><p>Keep it Efficient</p></li><li><p>Always build upon known and good foundations</p></li></ul></div></li></ul></div></section><section id="keep_pipelines_efficient"><h2>Keep Pipelines Efficient</h2><div class="imageblock" style=""><img src="./images/cd-pipeline-wait.jpg" alt="cd pipeline wait" width="400"></div>
<div class="ulist"><ul><li><p>Try to parallelized the long-running steps:</p><div class="ulist"><ul><li><p>Distribute by default automated ones: build, tests&#8230;&#8203;</p></li><li><p>Manual steps should be tightly measured: Are they <em>really</em> needed ?</p></li></ul></div></li><li><p>You can even make manual gates parallelized:</p><div class="ulist"><ul><li><p>Think it as a 1-N or N-1 relationship</p></li><li><p>Each stage of the <em>N</em> is a deployment to a different environment</p></li></ul></div></li></ul></div></section><section id="distributing_the_build_stage"><h2>Distributing the Build Stage</h2><div class="ulist"><ul><li><p>The <em>build</em> stage:</p><div class="ulist"><ul><li><p>Fully automated stage.</p></li><li><p>Automated Gates to trigger: event from the SCM (commit, merge, pull-request)</p></li></ul></div></li><li><p>Easy to distribute to be efficient:</p><div class="ulist"><ul><li><p>Parallelize builds of different target architectures or OSes (ARM, Windows, Android&#8230;&#8203;)</p></li><li><p>Parallelize builds on independents modules of your code before assembling (Map &amp; Reduce)</p></li><li><p>Unit and Integration tests are tied to the code: run them in parallel !</p></li></ul></div></li></ul></div></section><section id="distributing_the_deployment_stage"><h2>Distributing the Deployment Stage</h2><div class="ulist"><ul><li><p>The <em>deployment</em> stage:</p><div class="ulist"><ul><li><p>Should be automated, but can be manual</p></li><li><p>Gates can be as well manual as automated</p></li></ul></div></li><li><p>Easy to distribute the automated ones</p></li><li><p>You can also distribute manual gate-based if they are on different environments</p></li></ul></div></section><section id="an_optimized_pipeline_example"><h2>An Optimized Pipeline Example</h2><div class="imageblock" style=""><img src="./images/cd-pipeline-optimized-example.png" alt="cd pipeline optimized example"></div></section><section id="always_build_upon_good_foundations"><h2>Always Build upon Good Foundations</h2><div class="ulist"><ul><li><p>Introducing Binary reuse: <em>"Only Build Your Binaries Once"</em></p><div class="ulist"><ul><li><p>Compiling again a given binary violates the efficiency rule,
(shorter build time)</p></li><li><p>Ensure you same version of codebase is used across the pipeline</p></li><li><p>If the binary does not comply with "deployable" rule,
then it must fails a test</p></li><li><p>Focus on failing-fast</p></li></ul></div></li></ul></div></section><section id="what_did_we_learn_4"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>CD Pipeline is a great way to achieve your journey to Continuous Delivery</p></li><li><p>It is a model of your value stream mapping</p></li><li><p>Keep your pipelines efficient by parallelizing</p></li><li><p>Focus on failing-fast</p></li><li><p>Reuse good pipeline runs</p></li></ul></div></section><section id="going_further_4"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="http://devops.com/2014/07/29/continuous-delivery-pipeline/" class="bare">http://devops.com/2014/07/29/continuous-delivery-pipeline/</a></p></li><li><p><a href="http://martinfowler.com/bliki/DeploymentPipeline.html" class="bare">http://martinfowler.com/bliki/DeploymentPipeline.html</a></p></li><li><p><a href="http://www.informit.com/articles/article.aspx?p=1621865" class="bare">http://www.informit.com/articles/article.aspx?p=1621865</a></p></li><li><p><a href="https://www.thoughtworks.com/insights/blog/architecting-continuous-delivery" class="bare">https://www.thoughtworks.com/insights/blog/architecting-continuous-delivery</a></p></li></ul></div></section></section>
<section><section id="the_feedback_loop"><h2>The Feedback loop</h2></section><section id="why_having_a_feedback_loop"><h2>Why having a Feedback Loop ?</h2><div class="ulist"><ul><li><p><em>Context:</em> Continuous Delivery implemented with CD Pipeline</p></li><li><p><em>Target:</em> Focusing on fast feedback to react quickly</p></li><li><p><strong>Need</strong> systems that give <strong>quick</strong> feedback to pipeline&#8217;s <strong>actors</strong></p><div class="ulist"><ul><li><p>Key to success on the <em>efficiency</em> rule</p></li><li><p>Give <strong>confidence</strong> to the actor: they when when it breaks</p></li></ul></div></li></ul></div></section><section id="what_is_a_feedback_loop"><h2>What is a Feedback loop ?</h2><div class="ulist"><ul><li><p>The feedback loop is the set of tools that:</p><div class="ulist"><ul><li><p>Provides <strong>status</strong> of each step of the pipeline</p></li><li><p>Give the <strong>right</strong> message to the <strong>right</strong> actor of the pipeline</p></li><li><p>Is also a great source of <strong>measures</strong></p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="./images/cd-howto-pipeline.png" alt="cd howto pipeline" width="600"></div></section><section id="how_to_implement_a_feedback_loop"><h2>How to Implement a Feedback Loop ?</h2><div class="ulist"><ul><li><p>Start by evaluating:</p><div class="ulist"><ul><li><p>Which <strong>actors</strong> ? (Developers, Operation, Project Manager, Business)</p></li><li><p>Which communication <strong>media</strong> ? (Direct Visualization, E-Mail, IRC, Collaboration chats, Video messaging, <a href="http://www.papercut.com/blog/chris/2011/08/19/who-broke-the-build/">Extreme Feedback Devices</a>)</p></li><li><p>Which <strong>triggers</strong>, <em>priorities</em>, frequencies and limits ? (Stage status change, Mail gray-listing, Production feedback vs. testing feedback)</p></li></ul></div></li></ul></div></section><section id="measuring_the_pipeline_kpis_and_metrics"><h2>Measuring the pipeline: KPIs and Metrics</h2><div class="ulist"><ul><li><p>Goal of a pipeline is to provide model for the value stream:</p><div class="ulist"><ul><li><p>Each stage have a <em>Value added time</em></p></li><li><p>Each gate have an <em>elapsed time</em></p></li></ul></div></li><li><p>Keeping feedback on those values is <strong>mandatory</strong> to ensure value is still there</p></li><li><p>Adding feedback metrics to pipeline metrics helps you:</p><div class="ulist"><ul><li><p>Provides information to Business</p></li><li><p>Helps technical choices</p></li><li><p>Avoiding over-optimization</p></li></ul></div></li></ul></div></section><section id="what_did_we_learn_5"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>Having a pipeline is not enough: you need feedback</p></li><li><p>Feedback will target different different actors, in a lot of ways</p></li><li><p>Feedback improves the measures of your value stream mapping</p></li><li><p>Fast feedback helps to focus on fail fast</p></li></ul></div></section><section id="going_further_5"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="http://www.informit.com/articles/article.aspx?p=1621865" class="bare">http://www.informit.com/articles/article.aspx?p=1621865</a></p></li><li><p><a href="https://www.thoughtworks.com/insights/blog/architecting-continuous-delivery" class="bare">https://www.thoughtworks.com/insights/blog/architecting-continuous-delivery</a></p></li><li><p><a href="http://stackify.com/continuous-delivery-for-winners-with-a-feedback-loop/" class="bare">http://stackify.com/continuous-delivery-for-winners-with-a-feedback-loop/</a></p></li><li><p><a href="http://devops.com/2014/09/29/four-key-vectors-closing-devops-feedback-loop/" class="bare">http://devops.com/2014/09/29/four-key-vectors-closing-devops-feedback-loop/</a></p></li></ul></div></section></section>
<section><section id="security"><h2>Security</h2></section><section id="why_do_security"><h2>Why do Security ?</h2><div class="ulist"><ul><li><p>Your organization uses <em>information</em> to create value</p></li><li><p>Information is valuable and <strong>must</strong> follow:</p><div class="ulist"><ul><li><p>Confidentiality</p></li><li><p>Integrity</p></li><li><p>Availability</p></li></ul></div></li><li><p>Having <strong>Security</strong> concerns allows respecting those rules</p></li></ul></div></section><section id="what_is_security"><h2>What is Security ?</h2><div class="ulist"><ul><li><p>Security is the set of practices and tools to fight and prevent <strong>threats</strong></p></li><li><p>It&#8217;s all about following those principles:</p><div class="ulist"><ul><li><p><strong>Knowing the system</strong></p></li><li><p><strong>Least privilege:</strong> If you do not need to do it, you don&#8217;t have the right to do it.</p></li><li><p><strong>Defense in Depth:</strong> System are layered. Put security on all layers.</p></li><li><p><strong>Preventing is good. Detection is better:</strong> Continuous monitoring and detecting.</p></li></ul></div></li></ul></div></section><section id="how_to_do_security_least_privilege"><h2>How to do security ? Least privilege</h2><div class="ulist"><ul><li><p>Handling "Least privileges" concepts makes you manage the <strong>AAA</strong> concepts:</p><div class="ulist"><ul><li><p>Authentication</p></li><li><p>Authorization</p></li><li><p>Accounting</p></li></ul></div></li></ul></div></section><section id="authentication"><h2>Authentication</h2><div class="ulist"><ul><li><p>Authentication is the set of tools and procedures that permits to <strong>identify</strong>
a user with <em>enough confidence</em></p><div class="ulist"><ul><li><p>When police controls your ID, it is authentication</p></li><li><p>Using a login and a password is an authentication</p></li><li><p>Biometrics are also a type of authentication</p></li><li><p>2FA, that stands for "Two Factor Authentication" is a stronger authentication</p></li></ul></div></li></ul></div>
<div class="imageblock" style=""><img src="./images/security-authentication.jpg" alt="security authentication" width="600"></div></section><section id="authorization"><h2>Authorization</h2><div class="ulist"><ul><li><p>Once a given user is <em>authenticated</em>, important question arise:<br>
Does it have the right to do a given action ?</p></li><li><p><strong>Authorization</strong> always occurs in the context of <em>authentication</em></p></li><li><p>Common model pattern often founds:</p><div class="ulist"><ul><li><p><strong>Resources:</strong> Tasks, object and/or action to manipulate</p></li><li><p><strong>Roles:</strong> A set of rights grouped together by commodity</p></li><li><p><strong>Requesters:</strong> User or group, that have roles assigned,
and want to manipulates resources</p></li></ul></div></li><li><p>It is easy to visualize and enforce with a <strong>Security Matrix</strong></p></li></ul></div></section><section id="accounting"><h2>Accounting</h2><div class="ulist"><ul><li><p>Occurs in the context of a user both <strong>authenticated</strong> and <strong>authorized</strong>.</p></li><li><p>It <strong>measures</strong> resources used or consumed by the user during access.</p></li><li><p>This can be amount of data, compute resources, but also system time.</p></li><li><p>It enforces <strong>limits</strong> when they are defined to protect system.</p></li><li><p>Related to system measurement, <strong>capacity planning</strong> and feedback loops</p></li></ul></div></section><section id="how_to_do_security_defense_in_depth"><h2>How to do security ? Defense in Depth:</h2><div class="ulist"><ul><li><p>Defense in Depth is not an easy subject,
but we are focusing on the <strong>Credentials</strong></p><div class="ulist"><ul><li><p>Given the previous AAA context</p></li><li><p>A lot of systems for stages of pipelines (SCM, CI Server, Environment, WebServices, etc.)</p></li><li><p>How to enforce homogeneity of AAA ?</p></li></ul></div></li><li><p><strong>Credential management</strong> are the practices and tools that avoid leaking authentication
information to non authorized users.</p></li></ul></div></section><section id="how_to_do_security_detection_is_better"><h2>How to do security ? Detection is better</h2><div class="ulist"><ul><li><p>Security has to be <strong>meta</strong>: how to enforce security itself ?</p></li><li><p><strong>Auditing</strong> the security processes and system is a method to <strong>validate</strong> them.</p></li><li><p>It can be seen as an Acceptance Testing:</p><div class="ulist"><ul><li><p>Need to be continuously run</p></li><li><p>Should be done by someone that did not do this</p></li><li><p>It can be related to external certification for external confidence (e.g. PCI)</p></li></ul></div></li></ul></div></section><section id="what_did_we_learn_6"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>Security is a required discipline that must be taken into account
from beginning</p></li><li><p>It is a large subject but enforcing the rules is a big win</p></li><li><p>Implementing AAA framework is a good way to start</p></li><li><p>Security is related to feedback: which action to take when a problem arises ?</p></li><li><p>Measurement is not an option, but a must have</p></li></ul></div></section><section id="going_further_6"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="https://danielmiessler.com/study/infosecconcepts/" class="bare">https://danielmiessler.com/study/infosecconcepts/</a></p></li><li><p><a href="http://searchsecurity.techtarget.com/definition/authentication-authorization-and-accounting" class="bare">http://searchsecurity.techtarget.com/definition/authentication-authorization-and-accounting</a></p></li><li><p><a href="http://www.nap.edu/read/1581/chapter/1" class="bare">http://www.nap.edu/read/1581/chapter/1</a></p></li><li><p><a href="https://cryptome.org/2013/09/infosecurity-cert.pdf" class="bare">https://cryptome.org/2013/09/infosecurity-cert.pdf</a></p></li><li><p><a href="https://danielmiessler.com/study/infosecconcepts/" class="bare">https://danielmiessler.com/study/infosecconcepts/</a></p></li></ul></div></section></section>
<section><section id="configuration_management_cm"><h2>Configuration Management (CM)</h2></section><section id="why_use_cm"><h2>Why use CM ?</h2><div class="ulist"><ul><li><p>Ideal World: a Production Environment always stay the same</p></li><li><p>Real World: software systems change very often</p></li><li><p>Configuration Management (CM) allows to handle changes
on your software systems, maintaining its integrity over time.</p></li></ul></div></section><section id="what_is_cm"><h2>What is CM ?</h2><div class="ulist"><ul><li><p>CM is a global practice of handling systematic changes</p></li><li><p>In the software world, CM is a detailed recording of
all assets:</p><div class="ulist"><ul><li><p>Including configuration data, updates history</p></li><li><p>Both hardware and software assets are tracked</p></li></ul></div></li><li><p>Good practice is to use <strong>Unified CM</strong>, that require a single software suite
that will implement it</p></li></ul></div></section><section id="how_to_do_cm"><h2>How to do CM ?</h2><div class="ulist"><ul><li><p>Software CM identifies four domains for each software element:</p><div class="ulist"><ul><li><p><strong>Configuration identification:</strong> Process of knowing all attributes defining a configuration item</p></li><li><p><strong>Configuration control:</strong> Set of stages required to change a configuration item&#8217;s attributes</p></li><li><p><strong>Configuration status accounting:</strong> Ability to record and report at any time the configuration&#8217;s item attributes</p></li><li><p><strong>Configuration audits:</strong> Auditing both physical and functional configuration&#8217;s item attributes</p></li></ul></div></li></ul></div></section><section id="how_to_do_cm_2"><h2>How to do CM ?</h2><div class="ulist"><ul><li><p>Select a tool that fits your needs</p><div class="ulist"><ul><li><p>Chef, Puppet, Ansible, CFEngine, etc.</p></li></ul></div></li><li><p>Use Configuration as Code, and try to learn Infrastructure as Code</p><div class="ulist"><ul><li><p>Store everything in SCMs</p></li><li><p>Even your Infrastructure state</p></li></ul></div></li></ul></div></section><section id="what_did_we_learn_7"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>Configuration Management is the key handle changes</p></li><li><p>Store every piece of configuration in SCM to solve common problems</p></li><li><p>Have a procedure and policies for change management</p></li></ul></div></section><section id="going_further_7"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="https://en.wikipedia.org/wiki/Configuration_management" class="bare">https://en.wikipedia.org/wiki/Configuration_management</a></p></li><li><p><a href="http://www.sei.cmu.edu/productlines/frame_report/config.man.htm" class="bare">http://www.sei.cmu.edu/productlines/frame_report/config.man.htm</a></p></li><li><p><a href="http://searchitoperations.techtarget.com/definition/configuration-management-CM" class="bare">http://searchitoperations.techtarget.com/definition/configuration-management-CM</a></p></li></ul></div></section></section>
<section><section id="containers"><h2>Containers</h2></section><section id="why_use_containers"><h2>Why use Containers ?</h2><div class="ulist"><ul><li><p>Containers avoid traditional Virtualization Resources Overhead</p><div class="ulist"><ul><li><p>Efficient Resource Usage</p></li></ul></div></li><li><p>Containers implements <em>easily</em> the <strong>immutable machines</strong> patterns</p><div class="ulist"><ul><li><p>Reusability and portability nodes</p></li></ul></div></li><li><p>It provides <strong>fast</strong> startup (~1s) and tear-downs (~2s)</p><div class="ulist"><ul><li><p>Accelerate your workloads</p></li></ul></div></li></ul></div></section><section id="what_are_containers"><h2>What are Containers ?</h2><div class="ulist"><ul><li><p>Containerization is &gt;10 years technology, from OS kernel-based like Linux,
allowing to <strong>run isolated programs</strong></p></li><li><p>Compared to traditional Virtualization, it does not require to instantiate
a complete underlying OS: containers runs on their hosts&#8217;s <em>metal</em></p></li></ul></div>
<div class="imageblock" style=""><img src="./images/containers-vs-vm.jpg" alt="containers vs vm"></div></section><section id="containers_key_players"><h2>Containers Key Players</h2><div class="ulist"><ul><li><p>Containers technologies exists since years, coming from web hosting:</p><div class="ulist"><ul><li><p>LXC (since 2006)</p></li><li><p>OpenVZ, from Virtuozzo (since 2005)</p></li><li><p>Solaris Zones (2004)</p></li><li><p>BSD Jails (2001)</p></li></ul></div></li><li><p>New players are there, and are currently dominating this world:</p><div class="ulist"><ul><li><p><strong>Docker</strong>, from Docker Inc., which has made containerization
available for masses</p><div class="ulist"><ul><li><p>We&#8217;re going to focus on this one</p></li></ul></div></li><li><p><em>rkt</em> from CoreOS, main Docker opponent</p></li></ul></div></li></ul></div></section><section id="how_are_containers_working"><h2>How are Containers Working ?</h2><div class="ulist"><ul><li><p>Containers starts from an <strong>image</strong> (kind of template)</p><div class="ulist"><ul><li><p>Image is <strong>immutable</strong>. Change is needed ? Build a <em>new</em> image</p></li></ul></div></li><li><p>Common pattern is <strong>1</strong> process inside <strong>1</strong> container</p><div class="ulist"><ul><li><p>Complexity is managed at containers orchestration level</p></li><li><p>Easier to maintain</p></li></ul></div></li><li><p>Isolation is provided by kernel capabilities (control groups, namespacing,
system call restrictions&#8230;&#8203;). You can see it as a <em>Chroot on steroids</em></p></li></ul></div></section><section id="how_to_running_container_with_docker"><h2>How to: Running Container with Docker</h2><div class="olist arabic"><ol class="arabic"><li><p>Pull the Official Jenkins image<br></p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">docker pull jenkins</code></pre></div></div></li><li><p>Run a new container (instance) based on this template on 8080 port</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">docker run -p 8080:8080 jenkins
# Which process is run ? 'jenkins' images takes care of this</code></pre></div></div></li><li><p>Access your Jenkins instance on <a href="http://localhost:8080" class="bare">http://localhost:8080</a></p></li><li><p>Notice that you did not installed Jenkins nor Java on your host !</p></li></ol></div></section><section id="what_did_we_learn_8"><h2>What did we learn ?</h2><div class="ulist"><ul><li><p>Containers are a technology that provide lightweight isolation</p></li><li><p>It is useful to provide repeatability and portability</p></li><li><p>It allows an easy implementation of immutable machines
(compared to traditional provisioning)</p></li><li><p>We&#8217;re going to focus on Docker, one of the current container technologies</p></li></ul></div></section><section id="going_further_8"><h2>Going further</h2><div class="paragraph"><p>Some recommended readings on this subject:</p></div>
<div class="ulist"><ul><li><p><a href="https://docs.docker.com/engine/getstarted/" class="bare">https://docs.docker.com/engine/getstarted/</a></p></li><li><p><a href="https://www.mirantis.com/blog/what-are-containers-and-why-do-they-matter-to-openstack/" class="bare">https://www.mirantis.com/blog/what-are-containers-and-why-do-they-matter-to-openstack/</a></p></li><li><p><a href="http://www.cio.com/article/2924995/enterprise-software/what-are-containers-and-why-do-you-need-them.html" class="bare">http://www.cio.com/article/2924995/enterprise-software/what-are-containers-and-why-do-you-need-them.html</a></p></li><li><p><a href="https://coreos.com/rkt/docs/latest/" class="bare">https://coreos.com/rkt/docs/latest/</a></p></li></ul></div></section></section>
<section><section id="jenkins_overview"><h2>Jenkins overview</h2></section><section id="meet_jenkins"><h2>Meet Jenkins&#8230;&#8203;</h2><div class="ulist"><ul><li><p>#1 Continuous Integration and Delivery server</p></li><li><p>Created by Kohsuke Kawaguchi</p></li><li><p>An independent and active community (jenkins.io)</p></li><li><p>10 years old</p></li><li><p>500+ releases to date</p></li><li><p>100,000 active installations</p></li><li><p>300,000 Jenkins servers</p></li><li><p>1,200+ plugins</p></li></ul></div>
<div class="imageblock" style=""><img src="./images/butler-w-kk.png" alt="butler w kk" width="200"></div>
<div class="paragraph footer"><p>Source: 2014 Java Tools and Technologies Landscape – Rebel Labs</p></div></section><section><div class="imageblock" style=""><img src="./images/java-leaderboard.png" alt="java leaderboard" width="800"></div></section><section id="jenkins_popularity_through_the_roof"><h2>Jenkins Popularity: Through the Roof</h2><div class="imageblock" style="float: left"><img src="./images/jenkins-on-ci-radar.png" alt="jenkins on ci radar"></div><div class="title"><a href="http://www.infoq.com/research/ci-server" class="bare">http://www.infoq.com/research/ci-server</a></div>
<div class="imageblock" style="float: right"><img src="./images/jenkins-worldwide-stats.png" alt="jenkins worldwide stats"></div><div class="title"><a href="http://stats.jenkins.io/" class="bare">http://stats.jenkins.io/</a></div></section><section id="worldwide_adoption"><h2>Worldwide Adoption</h2><div class="imageblock" style=""><img src="./images/jenkins-worldwide-adoption.png" alt="jenkins worldwide adoption"></div></section><section id="jenkins_is_the_cd_orchestrator"><h2>Jenkins is the CD Orchestrator</h2><div class="imageblock" style=""><img src="./images/jenkins-cd-orchestrator.png" alt="jenkins cd orchestrator" width="600"></div></section></section>
<section><section id="cloudbees_introduction"><h2>CloudBees Introduction</h2></section><section id="cloudbees_and_the_jenkins_community"><h2>CloudBees and the Jenkins Community</h2><div class="imageblock" style="float: right"><img src="./images/butler-w-kk.png" alt="butler w kk" width="200"></div>
<div class="ulist"><ul><li><p>Kohsuke Kawaguchi</p><div class="ulist"><ul><li><p>Community leader and CloudBees’ CTO</p></li></ul></div></li><li><p>Code and Releases</p><div class="ulist"><ul><li><p>CloudBees partners with the community on development</p></li><li><p>CloudBees engineers contribute a majority of Jenkins OSS code</p></li><li><p>CloudBees partners with the community on releases</p></li><li><p>CloudBees contributes fixes back to the community</p></li></ul></div></li><li><p>Produces Jenkins Quarterly Newsletter</p></li><li><p>Conducts Jenkins User Conferences</p></li></ul></div></section><section id="cloudbees_inc"><h2>CloudBees Inc.</h2><div class="ulist"><ul><li><p>Incorporated in April 2010</p></li><li><p>~ 200 people as of July 2016</p></li><li><p>Headcount and revenue tripled between January 2015 and July 2016</p></li><li><p>Presence in 14 countries</p></li><li><p>Offices:</p><div class="ulist"><ul><li><p>USA:</p><div class="ulist"><ul><li><p>Raleigh, Richmond, San Jose</p></li></ul></div></li><li><p>Europe:</p><div class="ulist"><ul><li><p>Sevilla (Spain), Reading (UK), Neuchatel (Switzerland)</p></li></ul></div></li></ul></div></li></ul></div></section><section id="follow_the_sun_24_7_support_locations"><h2>Follow-the-sun 24/7 Support locations</h2><div class="imageblock" style=""><img src="./images/cloudbees-follows-24h.png" alt="cloudbees follows 24h" width="800"></div></section><section id="we_deliver_jenkins_enterprise_scale"><h2>We Deliver Jenkins @ Enterprise Scale</h2><div class="imageblock" style=""><img src="./images/cloudbees-delivers-jenkins-at-scale.png" alt="cloudbees delivers jenkins at scale" width="800"></div></section><section id="cloudbees_jenkins_platform"><h2>CloudBees Jenkins Platform</h2><div class="imageblock" style=""><img src="./images/cloudbees-cjp-descr.png" alt="cloudbees cjp descr"></div></section><section id="cloudbees_jenkins_platform_enterprise_edition"><h2>CloudBees Jenkins Platform: Enterprise Edition</h2><div class="imageblock" style=""><img src="./images/cloudbees-cjp-ee.png" alt="cloudbees cjp ee" width="800"></div></section><section id="cloudbees_jenkins_platform_private_saas_edition"><h2>CloudBees Jenkins Platform: Private SaaS Edition</h2><div class="imageblock" style=""><img src="./images/cloudbees-cjp-pse.png" alt="cloudbees cjp pse" width="800"></div></section><section id="jenkins_services_from_cloudbees"><h2>Jenkins Services from CloudBees</h2><div class="imageblock" style=""><img src="./images/cloudbees-tools-for-jenkins.png" alt="cloudbees tools for jenkins"></div></section><section id="cloudbees_subscription_model"><h2>CloudBees Subscription Model</h2><div class="ulist"><ul><li><p>CloudBees sells subscriptions that entitle you to receive support for:</p><div class="ulist"><ul><li><p>CloudBees Jenkins Platform</p></li><li><p>OSS Jenkins including 1,200+ Open Source Plugins</p></li></ul></div></li><li><p>Customers are charged an annual subscription fee per installation</p><div class="ulist"><ul><li><p>Multi-year subscriptions are available</p></li></ul></div></li><li><p>A typical service subscription includes:</p><div class="ulist"><ul><li><p>Software updates, bug fixes, and upgrades</p></li><li><p>Technical support</p></li><li><p>stable versions, stable APIs, and more</p></li></ul></div></li></ul></div></section><section id="cloudbees_resources"><h2>CloudBees Resources</h2><div class="ulist"><ul><li><p>Customer Engagement</p><div class="ulist"><ul><li><p>Support</p></li><li><p>Knowledge Base</p></li><li><p>Diagnostics</p></li></ul></div></li><li><p>Professional Services</p><div class="ulist"><ul><li><p>Architecture Assessment &amp; CD Guidance</p></li><li><p>Bootstrap Implementation Services</p></li><li><p>Migration Assistance</p></li></ul></div></li><li><p>Certified Partners</p><div class="ulist"><ul><li><p>Training</p></li><li><p>DevOps transformation</p></li><li><p>DevOps integration</p></li><li><p>Custom Development</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Support &amp; Knowledge Base
<a href="https://cloudbees.zendesk.com/hc/en-us" class="bare">https://cloudbees.zendesk.com/hc/en-us</a></p></div>
<div class="paragraph"><p>Diagnostics
<a href="https://cloudbees.zendesk.com/hc/en-us/articles/203805390" class="bare">https://cloudbees.zendesk.com/hc/en-us/articles/203805390</a></p></div>
<div class="paragraph"><p>Professional Services
<a href="https://www.cloudbees.com/products/professional-services" class="bare">https://www.cloudbees.com/products/professional-services</a></p></div></aside></section></section>
<section><section id="lab"><h2>Lab</h2><div class="paragraph"><p>Assez parlé, salissons nous les mains !</p></div><div class="ulist"><ul><li><p>Ce "Lab" correspond aux étapes pratiquées ensemble durant l&#8217;après-midi.</p></li></ul></div></section><section id="pr_requis_au_lab"><h2>Pré-requis au Lab</h2><div class="paragraph"><p>Les éléments suivants doivent être installés au préalable :</p></div>
<div class="ulist"><ul><li><p>VirtualBox 5.1.x (<a href="https://www.virtualbox.org/" class="bare">https://www.virtualbox.org/</a>)</p><div class="ulist"><ul><li><p>But: Permettre le fonctionnement d&#8217;une VM</p></li></ul></div></li><li><p>Vagrant 1.9.x (<a href="https://www.vagrantup.com/" class="bare">https://www.vagrantup.com/</a>)</p><div class="ulist"><ul><li><p>But: Piloter la VM de manière automatique et partageable</p></li></ul></div></li><li><p>Une ligne de command "bash"</p><div class="ulist"><ul><li><p>Sous Windows, GitBash ou Cygwin sont de bons points de départ</p></li></ul></div></li></ul></div></section><section id="pourquoi_une_vm"><h2>Pourquoi une VM ?</h2><div class="paragraph"><p>L&#8217;utilisation d&#8217;une VM nous permet:</p></div>
<div class="ulist"><ul><li><p>D&#8217;éviter de perturber votre environement de travail</p></li><li><p>De nettoyer "correctement" une fois le lab terminé</p></li><li><p>De fournir un environement stable et reproductible</p></li><li><p>Mais entraîne un surcoût de performance</p></li></ul></div></section><section id="initialisation_du_lab"><h2>Initialisation du Lab</h2><div class="paragraph"><p>Ouvrir un terminal et saisir les commandes suivantes:</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash"># Vérifier la version et l'installation de Vagrant
$ vagrant -v

# Installer la VM localement (~1 Go à télécharger, 1 seule fois, depuis github.com)
$ vagrant box add jenkins-lab https://github.com/dduportal/snowcampio-2017/releases/download/1.1.0/snowcampio-2017.box

# Création d'un répertoire de travail et initialisation du projet
$ mkdir snowcamp-jenkins-lab &amp;&amp; cd snowcamp-jenkins-lab \
  &amp;&amp; vagrant init -m -f jenkins-lab

# Vérification en lisant le contenu du fichier Vagrantfile généré
$ cat Vagrantfile

# Démarrage de la VM
$ vagrant up

# Vérification du fonctionnement de la VM, "state" doit être à "running"
$ vagrant status</code></pre></div></div></section><section id="accs_aux_services"><h2>Accès aux services</h2><div class="ulist"><ul><li><p>La VM est démarrée, les services suivants sont accessibles :</p><div class="ulist"><ul><li><p>Un serveur Web pour la page d&#8217;accueil:</p><div class="ulist"><ul><li><p><a href="http://localhost:10000" class="bare">http://localhost:10000</a></p></li></ul></div></li><li><p>Une instance Jenkins (authentification: admin / snowcampio2017) :</p><div class="ulist"><ul><li><p><a href="http://localhost:10000/jenkins/" class="bare">http://localhost:10000/jenkins/</a></p></li></ul></div></li><li><p>Un serveur git, "<a href="https://gitea.io/">Gitea</a>", pour héberger le code
localement :</p><div class="ulist"><ul><li><p><a href="http://localhost:10000/gitserver/" class="bare">http://localhost:10000/gitserver/</a></p></li></ul></div></li><li><p>Une ligne de command "DevBox" en HTML:</p><div class="ulist"><ul><li><p><a href="http://localhost:10000/devbox" class="bare">http://localhost:10000/devbox</a></p></li></ul></div></li></ul></div></li><li><p>Ces services fonctionnent avec docker et docker-compose dans la VM:</p><div class="ulist"><ul><li><p>Tout est stocké dans <code>/var/customize</code> et <code>/var/lib/docker</code></p></li></ul></div></li></ul></div></section><section id="bien_commencer_avec_l_application_de_demo"><h2>Bien commencer avec l&#8217;application de demo</h2><div class="paragraph"><p>Avant de plonger dans l&#8217;usage de Jenkins, voici un exercice
permettant de maîtriser l&#8217;application de démo.</p></div></section><section id="gameoflife_maven_java"><h2>GameOfLife - Maven &amp; Java</h2><div class="ulist"><ul><li><p>Ouvrir le service "DevBox" à l&#8217;adresse
<a href="http://localhost:10000/devbox" class="bare">http://localhost:10000/devbox</a></p><div class="ulist"><ul><li><p>Une ligne de commande apparaît</p></li></ul></div></li><li><p>Saisir la séquence de commandes suivante :</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash"># Vérification de la présence des outils requis (java, maven git)
bash-4.3# java -version
bash-4.3# mvn -v
bash-4.3# git --version

# Récupération de l'application de démo
bash-4.3# git clone http://localhost:10000/gitserver/dev/gameoflife

# Exécution des commandes mvn, cf. slides pour intention
bash-4.3# cd gameoflife/
bash-4.3# ls -l # pom.xml =&gt; Projet Maven
# cf - https://maven.apache.org/
bash-4.3# mvn clean # Nettoyer l'espace de travail
bash-4.3# mvn compile # Compiler l'application et ses dépendences
bash-4.3# mvn test # Jouer les Tests Unitaires
bash-4.3# mvn package # Packager l'application dans son format final (WAR)
bash-4.3# mvn verify # Exécuter les tests d'intégration
bash-4.3# mvn install # Installer l'application dans ~/.m2</code></pre></div></div></section><section id="excuter_l_application_gameoflife"><h2>Exécuter l&#8217;application GameOfLife</h2><div class="ulist"><ul><li><p>Une fois l&#8217;application compilée, testée et "empaquetée":</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">bash-4.3# mvn -pl gameoflife-web jetty:run
...

# Application accessible sur http://localhost:9090

# Utiliser CTRL + C pour quitter</code></pre></div></div></section><section id="dmarrer_et_configurer_jenkins"><h2>Démarrer et configurer Jenkins</h2><div class="ulist"><ul><li><p>Accéder à Jenkins à l&#8217;adresse <a href="http://localhost:10000/jenkins/" class="bare">http://localhost:10000/jenkins/</a></p><div class="ulist"><ul><li><p>Authentification: admin / snowcampio2017</p></li></ul></div></li><li><p>Naviguer dans <strong>Manage Jenkins</strong> &#8594; <strong>Configure System</strong></p><div class="ulist"><ul><li><p>Vérifier que <strong># of executors</strong> est à <code>0</code></p></li></ul></div></li><li><p>Naviguer dans <strong>Manage Jenkins</strong> &#8594; <strong>Manage Nodes</strong> et créer un nouvel agent:</p><div class="ulist"><ul><li><p>Nom: <code>maven-agent</code></p></li><li><p>Label: <code>maven3-jdk8</code></p></li><li><p>"Remote root directory": <code>/home/jenkins</code></p></li><li><p>Launch Method: "Launch slave agent with SSH"</p></li><li><p>Hostname: maven-agent</p></li><li><p>Clef: Utiliser le credential "agent-ssh-key"</p></li></ul></div></li><li><p>Naviguer dans <strong>Manage Jenkins</strong> &#8594; <strong>Global Tool Configuration</strong></p><div class="ulist"><ul><li><p>Ajouter une nouvelle installation Maven nommée <code>maven3</code>, en mode automatique</p></li></ul></div></li></ul></div></section><section id="un_premier_job_d_intgration_continue"><h2>Un premier Job d&#8217;Intégration Continue</h2><div class="ulist"><ul><li><p>Récupérer l&#8217;adresse du dépôt Git local "gameoflife":</p><div class="ulist"><ul><li><p>Depuis la page d&#8217;accueil <a href="http://localhost:10000" class="bare">http://localhost:10000</a></p></li><li><p>Naviguer dans le <strong>Gitserver</strong></p></li><li><p>Aller dans <strong>Explore</strong> &#8594; <strong>dev:gameoflife</strong></p></li><li><p>Copier l&#8217;URL en haut à droite, prêt du bouton "HTTP" bleuté</p></li></ul></div></li><li><p>Créer un job de type "Freestyle" :</p><div class="ulist"><ul><li><p>Nom: <code>gameoflife-freestyle</code></p></li><li><p>Configurer le SCM sur le dépôt "gameoflife local", sans aucun "Credential"</p></li><li><p>Utiliser <code>gogs</code> pour le "Repository Browser",
avec l&#8217;adresse du dépôt sans le ".git" à la fin</p></li><li><p>Build Step: <strong>Invoke a top level Maven</strong></p><div class="ulist"><ul><li><p>Utiliser l&#8217;installation <code>maven3</code> et le goal <code>clean install</code></p></li></ul></div></li><li><p>Lancer un build manuellement pour tester</p></li></ul></div></li></ul></div></section><section id="un_meilleur_temps_de_rponse_code_retour_du_build"><h2>Un meilleur temps de réponse code &#8594; retour du build</h2><div class="ulist"><ul><li><p>Configurer un webhook depuis le dépôt local "gameoflife":</p><div class="ulist"><ul><li><p>Authentification dans <a href="http://localhost:10000/gitserver" class="bare">http://localhost:10000/gitserver</a></p><div class="ulist"><ul><li><p>Utiliser les identifiants suivants: dev / dev</p></li></ul></div></li><li><p>Accéder aux réglages "hooks" du dépôt git local:
<a href="http://localhost:10000/gitserver/dev/gameoflife/settings/hooks" class="bare">http://localhost:10000/gitserver/dev/gameoflife/settings/hooks</a></p></li><li><p>Ajouter un WebHook de type "Gitea", avec la paylod URL sur
<a href="http://localhost:10000/jenkins/gogs-webhook/?job=gameoflife-freestyle" class="bare">http://localhost:10000/jenkins/gogs-webhook/?job=gameoflife-freestyle</a></p><div class="ulist"><ul><li><p>Positionner les "triggers" (déclencheurs) sur <strong>I need everything</strong></p></li></ul></div></li><li><p>Tester les webhooks en cliquant dessus, puis le bouton
<strong>Test Delivery</strong> : un 2nd build doit être lancé</p></li></ul></div></li></ul></div></section><section id="visualiser_un_build_en_erreur"><h2>Visualiser un build en erreur</h2><div class="ulist"><ul><li><p>Visualiser un job en erreur + les changements associés:</p><div class="ulist"><ul><li><p>Via le dépôt local dans Gitea, naviguer sur le fichier
<code>gameoflife-core/src/main/java/com/wakaleo/gameoflife/domain/Cell.java</code>
et cliquer sur le stylo "Edit" en haut à droite</p></li><li><p>Modifier ligne 4 <code>DEAD_CELL(".");</code> en <code>DEAD_CELL("-");</code> puis enregistrer.</p></li><li><p>Un nouveau build est lancé tout seul (grâce au webhook),
son résultat sera "FAILED" car les tests ne passeront plus</p></li><li><p>Corriger l&#8217;erreur ensuite, enregistrer, un nouveau build est lancé,
retour à la "normale"</p></li><li><p>Visualiser la page du job, naviguer dans les menus "Recent Changes",
et cliquer sur le liens "gogs" pour voir les différences dans le dépôt Gitea</p></li></ul></div></li></ul></div></section><section id="pipeline_scripted_simple"><h2>Pipeline "Scripted" Simple</h2><div class="paragraph"><p>Un premier Pipeline Jenkins "scripted" (utilisant Groovy + DSL) :</p></div>
<div class="ulist"><ul><li><p>Créer un nouveau Job de type "Pipeline", nommé <code>gameoflife-pipeline</code></p></li><li><p>Conserver les options par défaut</p></li><li><p>Pipeline Définition: <strong>Pipeline script</strong>
(aka. inline, saisi directement dans l&#8217;interface)</p><div class="ulist"><ul><li><p>Ce n&#8217;est pas l&#8217;idéal : utilisation uniquement à des fin pédagogiques</p></li></ul></div></li><li><p>Utiliser le lien <strong>Pipeline Syntax</strong> pour ouvrir le générateur de "snippet"</p><div class="ulist"><ul><li><p>Adresse : <a href="http://localhost:10000/jenkins/job/gameoflife-pipeline/pipeline-syntax/" class="bare">http://localhost:10000/jenkins/job/gameoflife-pipeline/pipeline-syntax/</a></p></li></ul></div></li></ul></div></section><section id="exercice_pipeline_scripted_simple"><h2>Exercice - Pipeline "Scripted" Simple</h2><div class="ulist"><ul><li><p>Exercice : Créer un pipeline qui va cloner le dépôt et
afficher le contenu du dépôt</p></li><li><p>Indices: mots clefs à utiliser : <code>node</code>, <code>stage</code>, <code>git</code> et <code>sh</code></p><div class="ulist"><ul><li><p>Solution sur la prochaine slide</p></li></ul></div></li></ul></div></section><section id="solution_pipeline_scripted_simple"><h2>Solution - Pipeline "Scripted" Simple</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="groovy language-groovy">node('maven3-jdk8') {
   stage('Checkout Code') {
       git 'http://localhost:10000/gitserver/dev/gameoflife.git'
       sh 'ls -al'
   }
}</code></pre></div></div></section><section id="pipeline_scripted_avec_jenkinsfile"><h2>Pipeline "Scripted" avec Jenkinsfile</h2><div class="ulist"><ul><li><p>Objectif 1: Déplacer le script Pipeline dans le dépôt Git
(plutôt que dans Jenkins)</p></li><li><p>Configuration du job <code>gameoflife-pipeline</code> à changer:
<strong>Pipeline script from SCM</strong></p><div class="ulist"><ul><li><p>Configurer pour pointer sur le dépôt local git <code>gameoflife</code></p></li><li><p>Le build doit planter: pas de <code>Jenkinsfile</code> présent</p></li></ul></div></li><li><p>Dans Gitea:</p><div class="ulist"><ul><li><p>Modifier le WebHook pour pointer sur <code>gameoflife-pipeline</code>
au lieu de <code>gameoflife-freestyle</code></p></li><li><p>Créer un nouveau fichier <code>Jenkinsfile</code> à la racine du dépôt
(utiliser le bouton bleu <strong>New File</strong> en haut, au centre)</p></li><li><p>Remplir ce nouveau fichier avec le contenu de l&#8217;exercice précédent</p></li></ul></div></li><li><p>Grâce au webhook, le build a dû se construire avec succès</p></li></ul></div></section><section id="exercice_pipeline_scripted_avec_jenkinsfile"><h2>Exercice - Pipeline "Scripted" avec Jenkinsfile</h2><div class="ulist"><ul><li><p>Exercice : éditer le <code>Jenkinsfile</code> afin de résoudre les éléments suivants:</p><div class="ulist"><ul><li><p>Eviter la répétition de configuration Git (adresse du dépôt) entre
la configuration du job et le pipeline</p></li><li><p>Implémenter des étapes de Pipeline pour la compilation Maven</p></li><li><p>Les commandes Maven doivent utiliser l&#8217;installation "maven3"</p></li></ul></div></li><li><p>Indices : mots clefs à utiliser: <code>checkout scm</code>, <code>stage</code>,
<code>def mvnHome = tools (&#8230;&#8203;)</code> et <code>sh</code></p></li></ul></div></section><section id="solution_pipeline_scripted_avec_jenkinsfile"><h2>Solution - Pipeline "Scripted" avec Jenkinsfile</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="groovy language-groovy">node('maven3-jdk8') {
   stage('Checkout Code') { checkout scm }
   def mvnHome = tool 'maven3'
   stage('Build') {
       sh "${mvnHome}/bin/mvn clean compile"
   }
   stage('Unit Tests') {
       sh "${mvnHome}/bin/mvn test"
   }
   stage('Packaging') {
       sh "${mvnHome}/bin/mvn package"
   }
   stage('Integration Tests') {
       sh "${mvnHome}/bin/mvn verify"
   }
   stage('Install') {
       sh "${mvnHome}/bin/mvn install"
   }
}</code></pre></div></div></section><section id="exercice_amlioration_du_pipeline"><h2>Exercice - Amélioration du Pipeline</h2><div class="ulist"><ul><li><p>Objectifs:</p><div class="ulist"><ul><li><p>Simplifier les commandes Maven en utilisant des variables d&#8217;environnement</p></li><li><p>Utiliser un plugin compatible Maven pour la phase "Maven install"
afin de voir une 2nd façon de faire</p></li></ul></div></li><li><p>Exercice : Modifier le <code>Jenkinsfile</code> afin que toutes les commands
<code>sh</code> appellent la commande <code>mvn</code> simplement, sans préciser d&#8217;élément avant.
Ceci vous impose de supprimer la définition de variable <code>def &#8230;&#8203; = tools</code></p><div class="ulist"><ul><li><p>Lors de l&#8217;étape "mvn install", utiliser le plugin
<a href="https://wiki.jenkins-ci.org/display/JENKINS/Pipeline+Maven+Plugin" class="bare">https://wiki.jenkins-ci.org/display/JENKINS/Pipeline+Maven+Plugin</a></p></li><li><p>Utiliser la gestion des variables d&#8217;envrionnements,
en ajoutant l&#8217;emplacement de Maven dans la variable d&#8217;environnement "PATH"</p></li></ul></div></li><li><p>Indices : mots clefs à utiliser : <code>withEnv</code> et <code>withMaven</code></p></li></ul></div></section><section id="solution_amlioration_du_pipeline"><h2>Solution - Amélioration du Pipeline</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="groovy language-groovy">node('maven3-jdk8') {
   stage('Checkout Code') { checkout scm }
   withEnv(["PATH+MAVEN=${tool 'maven3'}/bin"]) {
       stage('Build') { sh "mvn clean compile" }
       stage('Unit Tests') { sh "mvn test" }
       stage('Packaging') { sh "mvn package" }
       stage('Integration Tests') { sh "mvn verify" }
   }
   withMaven(maven: 'maven3') {
       stage('Install') { sh "mvn install" }
   }
}</code></pre></div></div></section><section id="multibranch_pipeline_workflow_complexe"><h2>MultiBranch Pipeline + Workflow complexe</h2><div class="ulist"><ul><li><p>Objectifs:</p><div class="ulist"><ul><li><p>Utiliser la pratique recommandée du "MultiBranch Pipeline" pour implémenter
le "Pipeline as Code"</p></li><li><p>Appliquer ce workflow sur une amélioration du Pipeline pour
intégrer une validation manuelle dans l&#8217;IHM de Jenkins</p></li></ul></div></li><li><p>Créer un nouveau job Jenkins de type
"MultiBranch Pipeline", nommé <code>gameoflife</code>.</p><div class="ulist"><ul><li><p>Configuration: utiliser <strong>Add Source</strong> &#8594; <strong>Git</strong> &#8594; faire pointer
sur le dépôt <code>gameoflife</code> local comme précédemment</p></li><li><p>Modifier le WebHook pour pointer sur cette URL :
<a href="http://localhost:10000/jenkins/job/gameoflife/build?delay=0" class="bare">http://localhost:10000/jenkins/job/gameoflife/build?delay=0</a></p></li><li><p>Etudier le job: un dossier a été automatiquement créé,
avec un job pipeline "master" dedans, correspondant à votre branche.</p></li></ul></div></li></ul></div></section><section id="exercice_multibranch_pipeline_workflow_complexe"><h2>Exercice - MultiBranch Pipeline + Workflow complexe</h2><div class="ulist"><ul><li><p>Créer une nouvelle branche nommée <code>better-pipeline</code>, en utilisant la devbox:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="bash language-bash">rm -rf gameoflife
git clone http://localhost:10000/gitserver/dev/gameoflife.git
cd gameoflife
git checkout -b better-pipeline
touch .dummy-decoy
git add .
git config --global user.email "dev@localhost.com"
git config --global user.name "Dev"
git commit -m "Init branche better-pipeline"
git push origin better-pipeline
# Authenticate with dev / dev</code></pre></div></div>
<div class="ulist"><ul><li><p>Dans Gitea, éditer le fichier <code>Jenkinsfile</code> sur la nouvelle branch (recharger la page si besoin). Il faut implémenter une validation manuelle avant l&#8217;étape "Install"</p></li><li><p>Si aucune validation manuelle n&#8217;intervient avant 120 secondes, le build doit s&#8217;arrêter en status "failed"</p></li><li><p>Pour voir les validation de pipeline, utilisez le "Console Output", ou cliquer sur l&#8217;étape visuelle pour faire apparaitre le popup (ou utiliser BlueOcean)</p></li></ul></div></li><li><p>Indice: mots clef à utiliser: <code>stash</code>, <code>unstash</code>, <code>timeout</code> et <code>input</code></p></li></ul></div></section><section id="solution_multibranch_pipeline"><h2>Solution - MultiBranch Pipeline</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="groovy language-groovy">node('maven3-jdk8') {
  stage('Checkout Code') { checkout scm }
  withEnv(["PATH+MAVEN=${tool 'maven3'}/bin"]) {
    stage('Build') { sh "mvn clean compile" }
    stage('Unit Tests') { sh "mvn test" }
    stage('Packaging') { sh "mvn package" }
    stage('Integration Tests') {
        sh "mvn verify"
        stash includes: 'target/**', name: 'mvn-target'
    }
  }
}
stage('Waiting for approval') { timeout(time: 120, unit: 'SECONDS') { input 'OK to install ?' } }
node('maven3-jdk8') { withMaven(maven: 'maven3') {
  stage('Install') {
    unstash 'mvn-target'
    sh "mvn install"
  }
}}</code></pre></div></div></section></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: true,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'black',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'slide',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1280,
  height: 800,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script><div id="cloudbees-ruban">
  <img id="ensg-logo" src="images/logo-ensg.jpg" alt="ENSG Logo"/>

  <span id="presentation-title">CI / CD Introduction with Jenkins</span>

  <a id="linkToToc" href="#toc"><img src="images/toc-icon.png" alt="ToC Icon" /></a>

  <span id="cloudbees-copyright " class="copyright">© 2017 CloudBees, Inc.  All Rights Reserved</span>
</div></body></html>